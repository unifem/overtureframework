#include "GL_GraphicsInterface.h"
//     --- colour table 1: cgsh1.ct---

int colourTable[256][3] = 
{
        0,  0, 91,  0,  0, 91,  0,  0, 97,
        0,  0,104,  0,  0,111,  0,  0,117,
        0,  0,124,  0,  0,130,  0,  0,137,
        0,  0,144,  0,  0,150,  0,  0,157,
        0,  0,163,  0,  0,170,  0,  0,177,
        0,  0,184,  0,  0,190,  0,  0,197,
        0,  0,204,  0,  0,211,  0,  0,218,
        0,  0,224,  0,  0,231,  0,  0,238,
        0,  0,245,  0,  0,252,  0,  3,255,
        0, 10,255,  0, 16,255,  0, 23,255,
        0, 30,255,  0, 36,255,  0, 43,255,
        0, 49,255,  0, 56,255,  0, 63,255,
        0, 69,255,  0, 76,255,  0, 82,255,
        0, 89,255,  0, 96,255,  0,102,255,
        0,109,255,  0,115,255,  0,122,255,
        0,129,255,  0,135,255,  0,142,255,
        0,148,255,  0,155,255,  0,162,255,
        0,168,255,  0,175,255,  0,182,255,
        0,189,255,  0,195,255,  0,202,255,
        0,209,255,  0,216,255,  0,223,255,
        0,229,255,  0,236,255,  0,243,255,
        0,250,255,  0,255,252,  0,255,240,
        0,255,228,  0,255,216,  0,255,204,
        0,255,192,  0,255,180,  0,255,168,
        0,255,156,  0,255,144,  0,255,132,
        0,255,120,  0,255,108,  0,255,101,
        0,255,100,  0,255, 99,  0,255, 97,
        0,255, 96,  0,255, 94,  0,255, 93,
        0,255, 91,  0,255, 90,  0,255, 89,
        0,255, 87,  0,255, 86,  0,255, 85,
        5,255, 84, 12,255, 84, 18,255, 84,
       25,255, 84, 31,255, 84, 38,255, 84,
       45,255, 84, 51,255, 84, 58,255, 84,
       64,255, 84, 71,255, 84, 78,255, 84,
       84,255, 84, 91,255, 84, 97,255, 84,
      104,255, 84,111,255, 84,117,255, 84,
      124,255, 84,130,255, 84,137,255, 84,
      144,255, 84,150,255, 84,157,255, 84,
      163,255, 84,170,255, 84,177,255, 84,
      184,255, 84,190,255, 84,197,255, 84,
      204,255, 84,211,255, 84,218,255, 84,
      224,255, 84,231,255, 84,238,255, 84,
      245,255, 84,252,255, 84,255,255, 83,
      255,255, 79,255,255, 76,255,255, 73,
      255,255, 70,255,255, 67,255,255, 63,
      255,255, 60,255,255, 57,255,255, 54,
      255,255, 51,255,255, 47,255,255, 44,
      255,252, 41,255,248, 37,255,244, 34,
      255,240, 31,255,236, 27,255,232, 24,
      255,228, 20,255,224, 17,255,220, 14,
      255,216, 10,255,212,  7,255,208,  3,
      255,204,  0,255,200,  0,255,196,  0,
      255,192,  0,255,188,  0,255,184,  0,
      255,180,  0,255,176,  0,255,172,  0,
      255,168,  0,255,164,  0,255,160,  0,
      255,156,  0,255,152,  0,255,148,  0,
      255,144,  0,255,140,  0,255,136,  0,
      255,132,  0,255,128,  0,255,124,  0,
      255,120,  0,255,116,  0,255,112,  0,
      255,108,  0,255,104,  0,255, 98,  0,
      255, 90,  0,255, 82,  0,255, 74,  0,
      255, 66,  0,255, 58,  0,255, 50,  0,
      255, 42,  0,255, 34,  0,255, 26,  0,
      255, 18,  0,255, 10,  0,255,  2,  0,
      255,  0,  7,255,  0, 15,255,  0, 24,
      255,  0, 33,255,  0, 42,255,  0, 51,
      255,  0, 59,255,  0, 68,255,  0, 77,
      255,  0, 86,255,  0, 95,255,  0,103,
      255,  0,112,255,  0,117,255,  0,121,
      255,  0,125,255,  0,130,255,  0,134,
      255,  0,139,255,  0,143,255,  0,147,
      255,  0,152,255,  0,156,255,  0,161,
      255,  0,165,255,  0,170,255,  0,177,
      255,  0,184,255,  0,190,255,  0,197,
      255,  0,204,255,  0,211,255,  0,218,
      255,  0,224,255,  0,231,255,  0,238,
      255,  0,245,255,  0,252,255,  3,255,
      255, 10,255,255, 16,255,255, 23,255,
      255, 30,255,255, 36,255,255, 43,255,
      255, 49,255,255, 56,255,255, 63,255,
      255, 69,255,255, 76,255,255, 82,255,
      255, 89,255,255, 96,255,255,102,255,
      255,109,255,255,115,255,255,122,255,
      255,129,255,255,135,255,255,142,255,
      255,148,255,255,155,255,255,162,255,
      255,168,255 
     };

//\begin{>>GL_GraphicsInterfaceInclude.tex}{\subsection{setCurrentWindow}} 
void GL_GraphicsInterface::
setColourFromTable( const real value, GraphicsParameters & parameters)
// /Description:
//  Set the colour from a table defined in the GraphicsParameters.
// /value (input) : real value in the range [0,1]
// /parameters (input) : holds the colour table to use
// /Return value: none.
//
// /Author: WDH
//\end{GL_GraphicsInterfaceInclude.tex} 
//-------------------------------------------------------
{
  int index;
  real val,red,green,blue;
  switch( parameters.colourTable )
  {
   case GraphicsParameters::rainbow:
     index = min(max(int(value*255+.5),0),255);
    glColor3f(colourTable[index][0]/255.,colourTable[index][1]/255.,colourTable[index][2]/255.);
    break;
  case GraphicsParameters::gray:
    val=.25 +.65*value;    // gray scale starts at not too black
    // val=value;
    glColor3f(val,val,val);
    break;
  case GraphicsParameters::red:
    val=value;
    glColor3f(1.,val,val);       // go from white to red
    break;
  case GraphicsParameters::green:
    val=value;
    glColor3f(val,1.,val);
    break;
  case GraphicsParameters::blue:
    val=value;
    glColor3f(val,val,1.);
    break;
  case GraphicsParameters::userDefined:
    assert(parameters.colourTableFunction!=NULL );
    (*parameters.colourTableFunction)(value,red,green,blue);  // evaluate user defined colour table
    glColor3f(red,green,blue);
    break;
  default:
    cout << "GL_GraphicsInterface::setColourFromTable:ERROR: unknown colourTable\n";
    val=.5+.5*value;   
    glColor3f(val,val,val);
    break;
  }
}
